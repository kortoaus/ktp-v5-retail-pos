# 교대 근무 규칙

교대 근무(Shift)의 시작, 종료, 그리고 기록되는 내용에 대한 설명입니다.

---

## 개요

교대 근무는 하나의 터미널에서 하나의 근무 시간대를 나타냅니다. 터미널당 한 번에 하나의 교대만 열 수 있습니다. 근무 중 발생하는 모든 판매, 환불, 현금 입출금이 기록되고, 종료 시 요약됩니다.

---

## 교대 시작

### 시작할 수 있는 사람

**shift** 권한이 있는 사용자만 교대를 시작하거나 종료할 수 있습니다.

### 순서

1. 홈 화면에서 **Open Shift**를 터치합니다 (교대가 열려 있지 않을 때만 표시됩니다).
2. 서랍에 있는 현금을 권종별 그리드를 사용하여 세어 입력합니다.
3. 필요시 메모를 입력합니다 (예: "어제 잔돈").
4. **Open Shift**를 터치하여 확인합니다.

### 기록되는 내용

| 항목 | 설명 |
|------|------|
| 시작 현금 | 시작 시 서랍에 있는 현금 금액 (센트 단위로 저장) |
| 시작한 사람 | 교대를 시작한 사용자 |
| 시작 시간 | 교대가 시작된 날짜와 시간 |
| 메모 | 시작 시 입력한 선택적 메모 |

---

## 근무 중

터미널에서 발생하는 모든 활동이 현재 교대에 연결됩니다:

| 활동 | 기록 내용 |
|------|-----------|
| 판매 | 현금 수입, 카드 수입, GST |
| 환불 | 현금 환불, 카드 환불, GST |
| 현금 입금 | 서랍에 추가된 현금 (예: 잔돈 보충) |
| 현금 출금 | 서랍에서 제거된 현금 (예: 소액 경비) |

---

## 교대 종료

### 순서

1. 홈 화면에서 **Close Shift**를 터치합니다 (교대가 열려 있을 때만 표시됩니다).
2. 시스템이 현재 교대의 모든 판매, 환불, 현금 입출금을 조회하여 요약을 보여줍니다.
3. 서랍에 있는 현금을 권종별 그리드를 사용하여 세어 입력합니다.
4. 요약을 확인합니다:

| 항목 | 설명 |
|------|------|
| 시작 현금 | 교대 시작 시 서랍에 있던 현금 |
| 판매 (현금) | 판매로 받은 현금 합계 |
| 판매 (카드) | 판매로 받은 카드 결제 합계 |
| 판매 세금 | 판매에서 징수한 GST |
| 환불 (현금) | 환불로 돌려준 현금 합계 |
| 환불 (카드) | 환불로 돌려준 카드 결제 합계 |
| 환불 세금 | 환불에 포함된 GST |
| 현금 입금 | 근무 중 서랍에 추가된 현금 합계 |
| 현금 출금 | 근무 중 서랍에서 제거된 현금 합계 |
| 예상 현금 | 계산값: 시작 현금 + 판매 현금 - 환불 현금 + 현금 입금 - 현금 출금 |
| 실제 현금 | 방금 센 금액 |
| 차이 | 실제 - 예상 (초록 = 일치, 빨강 = 부족, 파랑 = 초과) |

5. 필요시 종료 메모를 입력합니다.
6. **Close Shift**를 터치합니다 — 한 번 더 확인을 요청합니다.
7. Z-리포트 영수증이 자동으로 인쇄됩니다.

### 확인 절차

교대 종료는 버튼을 두 번 터치해야 합니다:
- 첫 번째 터치: 버튼이 **"Tap again to confirm"**으로 변경
- 두 번째 터치: 교대가 종료됨

실수로 종료되는 것을 방지하기 위한 장치입니다.

---

## Z-리포트 (정산 영수증)

교대 종료 시 전체 요약이 포함된 영수증이 자동으로 인쇄됩니다:

- 교대 ID와 요일
- 시작/종료한 사람과 시간
- 판매 내역 (현금, 카드, GST)
- 환불 내역 (현금, 카드, GST)
- 현금 입출금 합계
- 서랍 요약 (시작, 예상, 실제, 차이)
- 인쇄 시간

---

## 금액 저장 방식

교대의 모든 금액은 **센트** 단위(정수)로 저장됩니다. 예를 들어 $15.50은 1550으로 저장됩니다. 이는 많은 거래를 합산할 때 반올림 오류를 방지합니다.

개별 거래의 판매, 환불, 현금 입출금 금액은 소수점이 있는 달러 단위입니다. 교대 종료 시 센트로 변환됩니다.

---

## 규칙 요약

| 규칙 | 상세 |
|------|------|
| 터미널당 하나의 교대 | 이미 열린 교대가 있으면 새 교대를 열 수 없음 |
| 교대 권한 필요 | "shift" 권한이 있는 사용자만 시작/종료 가능 |
| 시작과 종료 시 현금 확인 | 터치스크린 권종별 그리드로 현금 세기 |
| 예상 현금은 자동 계산 | 편집 불가 — 모든 교대 거래에서 산출 |
| 종료 시 이중 확인 | 실수 방지를 위해 두 번 터치 필요 |
| 종료 시 Z-리포트 인쇄 | 자동 — 인쇄 실패해도 종료는 차단되지 않음 |
| 교대 데이터는 변경 불가 | 종료 후 교대 기록은 수정할 수 없음 |
